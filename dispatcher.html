<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Ёлка — Диспетчер</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div class="app-root light-root">
  <header class="topbar">
    <div class="topbar-left">
      <div class="topbar-logo topbar-logo-light">▲</div>
      <span class="topbar-title topbar-title-dark">Ё л к а</span>
      <span class="badge-role badge-role-light">(Диспетчер)</span>
    </div>
    <div class="topbar-right">
      <button class="icon-btn" id="font-dec" title="Меньше шрифт">A−</button>
      <button class="icon-btn" id="font-inc" title="Больше шрифт">A+</button>
      <span class="counter" id="active-calls-count" title="Активные вызовы">0</span>
      <button class="icon-btn" id="back-to-roles" title="Роли">↻ Роли</button>
    </div>
  </header>

  <main class="main-layout main-layout-centered">
    <!-- Карта -->
    <section class="card">
      <header class="card-header">
        <div>
          <h2>Карта</h2>
        </div>
        <span class="muted">Учебный макет города «Невский»</span>
      </header>
      <div class="map-container">
        <iframe src="https://map.vzkn.ru/" allowfullscreen loading="lazy"></iframe>
      </div>
    </section>

    <!-- Активные вызовы -->
    <section class="card">
      <header class="card-header">
        <div class="card-header-left">
          <h2>Активные вызовы</h2>
        </div>
        <div class="card-header-right">
          <button class="btn btn-ghost btn-sm" id="history-btn">⟳ История</button>
        </div>
      </header>

      <form id="call-form" class="form-grid">
        <div class="form-group">
          <label for="call-street">Улица *</label>
          <input id="call-street" class="input-text" type="text" placeholder="Введите улицу" required />
        </div>
        <div class="form-group">
          <label for="call-desc">Описание *</label>
          <input id="call-desc" class="input-text" type="text" placeholder="Введите описание" required />
        </div>
        <div class="form-group">
          <label for="call-priority">Приоритет</label>
          <select id="call-priority" class="input-select">
            <option value="Обычный">Обычный</option>
            <option value="Высокий">Высокий</option>
            <option value="Экстренный">Экстренный</option>
          </select>
        </div>
        <div class="form-group form-group-buttons">
          <button type="submit" class="btn btn-primary">Создать вызов</button>
          <button type="button" class="btn btn-secondary" id="ai-generate-btn">Сгенерировать ИИ</button>
        </div>
      </form>

      <div class="table-wrapper">
        <table class="data-table data-table-light">
          <thead>
          <tr>
            <th>ID вызова</th>
            <th>Улица</th>
            <th>Описание</th>
            <th>Приоритет</th>
            <th>Статус</th>
            <th>Ресурсы</th>
            <th>Действия</th>
          </tr>
          </thead>
          <tbody id="calls-table-body"></tbody>
        </table>
      </div>
    </section>

    <!-- Список ресурсов -->
    <section class="card">
      <header class="card-header">
        <div class="card-header-left">
          <h2>Список ресурсов</h2>
        </div>
        <div class="card-header-right">
          <button id="merge-resources-btn" class="btn btn-secondary btn-sm">Объединить экипажи</button>
        </div>
      </header>

      <form id="resource-form" class="form-grid form-grid-4">
        <div class="form-group">
          <label for="res-name">Позывной</label>
          <input id="res-name" class="input-text" type="text" placeholder="Напр., Патруль 12" />
        </div>
        <div class="form-group">
          <label for="res-app">Канал / приложение</label>
          <input id="res-app" class="input-text" type="text" placeholder="Рация, Telegram..." />
        </div>
        <div class="form-group">
          <label for="res-status">Статус</label>
          <select id="res-status" class="input-select">
            <option value="Свободен">Свободен</option>
            <option value="В пути">В пути</option>
            <option value="На месте">На месте</option>
            <option value="Недоступен">Недоступен</option>
          </select>
        </div>
        <div class="form-group">
          <label for="res-call">Закреплён за вызовом</label>
          <select id="res-call" class="input-select">
            <option value="">— Нет —</option>
          </select>
        </div>
        <div class="form-group form-group-buttons">
          <button type="submit" class="btn btn-primary">Добавить ресурс</button>
        </div>
      </form>

      <div class="table-wrapper">
        <table class="data-table data-table-light">
          <thead>
          <tr>
            <th></th>
            <th>Позывной</th>
            <th>Канал</th>
            <th>Тип</th>
            <th>Статус</th>
            <th>Вызов</th>
            <th>Состав группы</th>
            <th>Действия</th>
          </tr>
          </thead>
          <tbody id="resources-table-body"></tbody>
        </table>
      </div>
    </section>

    <!-- Ориентировки -->
    <section class="card">
      <header class="card-header">
        <h2>Ориентировки</h2>
        <button class="btn btn-primary" id="add-orientation-btn">Добавить</button>
      </header>
      <div class="table-wrapper">
        <table class="data-table data-table-light">
          <thead>
          <tr>
            <th>Тип</th>
            <th>Заголовок</th>
            <th>Описание</th>
            <th>Активна</th>
            <th>Действия</th>
          </tr>
          </thead>
          <tbody id="orientation-table-body"></tbody>
        </table>
      </div>
    </section>

    <!-- Заметки -->
    <section class="card">
      <header class="card-header">
        <h2>Заметки <span id="notes-status" class="muted">Загружено</span></h2>
      </header>
      <textarea id="notes-field" class="notes-area notes-area-light" placeholder="Введите ваши заметки здесь..."></textarea>
    </section>
  
    <!-- Плавающая подсказка по радиообмену -->
    <button id="radio-hint-toggle" class="floating-hint-btn" title="Памятка по радиообмену">?</button>

    <div id="radio-hint" class="floating-hint hidden">
      <div id="radio-hint-header" class="floating-hint-header">
        <span>Памятка: политика радиопередач</span>
        <button id="radio-hint-close" class="icon-btn" type="button">&times;</button>
      </div>
      <div class="floating-hint-body">
        <p><strong>ЕДДС</strong> контролирует радиоэфир и действия экипажей во время смены.</p>
        <ul>
          <li>Принимать и фиксировать экстренные вызовы 112 и по рации.</li>
          <li>Направлять и отзывать экипажи, создавать ориентировки и рейды.</li>
          <li>Вводить режим радиомолчания и приоритетные передачи.</li>
        </ul>
        <p><strong>Фразеология:</strong></p>
        <ul>
          <li><em>«Невский-главный, принял, записал»</em> — подтверждение приёма информации.</li>
          <li><em>«Невский-главный, не принял, повторите последнюю радиопередачу»</em> — запрос повтора.</li>
          <li><em>«ЭКСТРЕННО-ЭКСТРЕННО…»</em> или <em>«Внимание всем…»</em> — прерывание радиоэфира.</li>
        </ul>
        <p><strong>Экстренные ситуации:</strong></p>
        <ul>
          <li>Преследование — направить минимум 2 экипажа ГИБДД и 1 экипаж ППС/Росгвардии.</li>
          <li>Применение оружия — СОГ и бригада СМП (или реанимация) немедленно.</li>
          <li>Сигнал «Угроза жизни» — максимум свободных сил + режим радиомолчания.</li>
        </ul>
        <p>Подробный регламент можно расширить в этом блоке, при необходимости.</p>
      </div>
    </div>
</main>

  <!-- Модальное окно ориентировки -->
  <div id="orientation-modal" class="modal-backdrop hidden">
    <div class="modal modal-light">
      <div class="modal-header">
        <h2>Добавить ориентировку</h2>
        <button id="orientation-close" class="icon-btn">&times;</button>
      </div>
      <form id="orientation-form" class="modal-body">
        <div class="form-group">
          <label for="orientation-type">Тип *</label>
          <select id="orientation-type" class="input-select">
            <option value="Ориентировка">Ориентировка</option>
            <option value="Рейд">Рейд</option>
          </select>
        </div>
        <div class="form-group">
          <label for="orientation-title">Заголовок *</label>
          <input id="orientation-title" class="input-text" type="text" placeholder="Например, Трезвый водитель" />
        </div>
        <div class="form-group">
          <label for="orientation-desc">Описание *</label>
          <textarea id="orientation-desc" class="input-textarea" placeholder="Подробное описание"></textarea>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Создать</button>
          <button type="button" id="orientation-cancel" class="btn btn-secondary">Закрыть</button>
        </div>
      </form>
    </div>
  </div>
</div>
<script src="script.js"></script>
</body>
</html>
